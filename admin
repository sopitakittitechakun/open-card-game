<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  :root{
    --bg:#0b0b0b; --card:#141414; --card2:#0f0f0f;
    --txt:#fff; --muted:rgba(255,255,255,.72);
    --line:rgba(255,255,255,.10);
    --red:#ff2b2b; --green:#19ff8a; --yellow:#ffc94a;
    --radius:18px;
    --shadow:0 18px 60px rgba(0,0,0,.55);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Tahoma,sans-serif;color:var(--txt);background:transparent}
  .wrap{padding:14px}
  .hero{
    background:linear-gradient(135deg, rgba(255,43,43,.22), rgba(255,255,255,.06));
    border:1px solid var(--line);
    border-radius:20px;
    padding:14px;
    box-shadow:var(--shadow);
  }
  .row{display:flex;gap:10px;align-items:center;justify-content:space-between}
  .title{font-weight:900;letter-spacing:.2px}
  .sub{color:var(--muted);font-size:12px;margin-top:4px;line-height:1.45}
  .pill{
    display:inline-flex;align-items:center;gap:8px;
    padding:6px 10px;border-radius:999px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.06);
    font-size:12px;color:var(--muted);white-space:nowrap;
  }
  .stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:12px}
  .stat{border:1px solid var(--line);border-radius:16px;padding:10px;background:rgba(0,0,0,.22)}
  .k{font-size:12px;color:var(--muted)}
  .n{font-size:18px;font-weight:900;margin-top:4px}
  .tabs{display:flex;gap:8px;margin-top:12px}
  .tab{
    flex:1;padding:10px;border-radius:14px;
    border:1px solid var(--line);background:rgba(255,255,255,.04);
    color:var(--muted);font-weight:900;font-size:12px;cursor:pointer;
  }
  .tab.active{background:rgba(255,43,43,.18);color:#fff;border-color:rgba(255,43,43,.35)}
  .panel{
    margin-top:12px;background:var(--card);border:1px solid var(--line);
    border-radius:20px;padding:12px;box-shadow:var(--shadow);
  }
  label{display:block;margin:10px 0 6px;color:var(--muted);font-size:12px}
  input,select,textarea{
    width:100%;padding:10px 12px;border-radius:14px;border:1px solid var(--line);
    background:var(--card2);color:#fff;outline:none;
  }
  textarea{min-height:70px;resize:vertical}
  .btns{display:flex;gap:10px;margin-top:10px}
  button{
    width:100%;padding:11px 12px;border-radius:14px;border:0;
    font-weight:900;cursor:pointer;
  }
  .btn-red{background:var(--red);color:#fff}
  .btn-dark{background:rgba(255,255,255,.10);border:1px solid var(--line);color:#fff}
  .btn-yellow{background:rgba(255,201,74,.18);border:1px solid rgba(255,201,74,.35);color:#fff}
  .msg{
    display:none;margin-top:10px;padding:10px 12px;border-radius:14px;border:1px solid var(--line);
    background:rgba(255,255,255,.06);white-space:pre-line
  }
  .msg.ok{border-color:rgba(25,255,138,.35)}
  .msg.err{border-color:rgba(255,43,43,.38)}
  .item{
    border:1px solid var(--line);background:rgba(0,0,0,.18);
    border-radius:16px;padding:10px;margin-top:10px
  }
  .item .t{font-weight:900;font-size:12px}
  .item .m{color:var(--muted);font-size:12px;margin-top:6px;line-height:1.45;white-space:pre-line}
  .badge{
    display:inline-flex;align-items:center;padding:4px 8px;border-radius:999px;
    font-size:11px;font-weight:900;border:1px solid var(--line);
    background:rgba(255,255,255,.06);color:var(--muted)
  }
  .right{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .hr{height:1px;background:var(--line);margin:12px 0}
</style>
</head>
<body>
<div class="wrap">

  <div class="hero">
    <div class="row">
      <div>
        <div class="title">üéõÔ∏è ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô RR365</div>
        <div class="sub">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ / ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å / ‡πÅ‡∏ö‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ blacklist) ‚Äî ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Sidebar ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
      </div>
      <div class="pill" id="pill">‚óè ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶</div>
    </div>

    <div class="stats">
      <div class="stat"><div class="k">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</div><div class="n" id="stP">-</div></div>
      <div class="stat"><div class="k">‡∏ú‡∏π‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div><div class="n" id="stB">-</div></div>
      <div class="stat"><div class="k">‡πÅ‡∏ö‡∏•‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå</div><div class="n" id="stBL">-</div></div>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="search">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      <button class="tab" data-tab="manage">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</button>
      <button class="tab" data-tab="recent">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
    </div>
  </div>

  <!-- SEARCH -->
  <div class="panel" id="panel-search">
    <div class="right">
      <div class="t">üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏ö‡∏≠‡∏£‡πå / deviceId / fingerprint / ua_key</div>
      <span class="badge">SEARCH</span>
    </div>
    <div class="m" style="color:var(--muted);font-size:12px;margin-top:6px;line-height:1.45">
      ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå participants + bind + blacklist ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
    </div>

    <label>‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
    <input id="q" placeholder="‡πÄ‡∏ä‡πà‡∏ô 0611111111 ‡∏´‡∏£‡∏∑‡∏≠ dev_xxx ‡∏´‡∏£‡∏∑‡∏≠ fp_xxx ‡∏´‡∏£‡∏∑‡∏≠ ua_xxx"/>

    <div class="btns">
      <button class="btn-red" id="btnSearch">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      <button class="btn-dark" id="btnClear">‡∏•‡πâ‡∏≤‡∏á</button>
    </div>

    <div class="msg" id="msgSearch"></div>
    <div id="result"></div>
  </div>

  <!-- MANAGE -->
  <div class="panel" id="panel-manage" style="display:none">
    <div class="right">
      <div class="t">üß∞ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å / ‡πÅ‡∏ö‡∏ô)</div>
      <span class="badge">MANAGE</span>
    </div>

    <label>‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå (‡∏•‡∏ö participants + bind ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ô‡∏±‡πâ‡∏ô)</label>
    <input id="unlockPhone" placeholder="0611111111"/>
    <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</label>
    <input id="unlockReason" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏î‡∏ú‡∏¥‡∏î / ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ / ‡πÅ‡∏Å‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"/>

    <div class="btns">
      <button class="btn-yellow" id="btnUnlock">‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå</button>
    </div>

    <div class="hr"></div>

    <div class="right">
      <div class="t">üö´ Blacklist (‡∏ñ‡πâ‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ó blacklist ‡πÅ‡∏•‡πâ‡∏ß)</div>
      <span class="badge">OPTIONAL</span>
    </div>

    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
    <select id="blType">
      <option value="PHONE">PHONE (‡πÄ‡∏ö‡∏≠‡∏£‡πå)</option>
      <option value="DEVICE">DEVICE (deviceId)</option>
      <option value="FP">FP (fingerprint)</option>
      <option value="UA">UA (ua_key)</option>
    </select>

    <label>‡∏Ñ‡πà‡∏≤</label>
    <input id="blValue" placeholder="‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô 0611111111 ‡∏´‡∏£‡∏∑‡∏≠ dev_xxx"/>

    <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</label>
    <textarea id="blReason" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏±‡πà‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå / ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á / ‡∏™‡πÅ‡∏õ‡∏° / ‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö"></textarea>

    <div class="btns">
      <button class="btn-red" id="btnBLOn">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ô</button>
      <button class="btn-dark" id="btnBLOff">‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ô</button>
    </div>

    <div class="msg" id="msgManage"></div>
  </div>

  <!-- RECENT -->
  <div class="panel" id="panel-recent" style="display:none">
    <div class="right">
      <div class="t">üïí ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
      <span class="badge">RECENT</span>
    </div>
    <div id="recent"></div>
    <div class="msg" id="msgRecent"></div>
  </div>

</div>

<script>
const $ = (id)=>document.getElementById(id);

function setPill(text, ok=true){
  const el = $("pill");
  el.textContent = (ok ? "‚óè " : "‚ö†Ô∏è ") + text;
  el.style.borderColor = ok ? "rgba(25,255,138,.35)" : "rgba(255,43,43,.35)";
}
function showMsg(id, text, type="ok"){
  const el = $(id);
  el.style.display="block";
  el.className = "msg " + (type==="err" ? "err":"ok");
  el.textContent = text;
}
function clearMsg(id){
  const el = $(id);
  el.style.display="none";
  el.textContent="";
}

document.querySelectorAll(".tab").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    btn.classList.add("active");
    const t = btn.dataset.tab;
    $("panel-search").style.display = (t==="search") ? "" : "none";
    $("panel-manage").style.display = (t==="manage") ? "" : "none";
    $("panel-recent").style.display = (t==="recent") ? "" : "none";
  });
});

function renderResult(data){
  const box = $("result");
  if(!data){ box.innerHTML=""; return; }

  const bl = data.blacklistHits || [];
  const p  = data.participants || [];
  const b  = data.bind;

  let html = "";

  if(bl.length){
    html += `<div class="item" style="border-color:rgba(255,43,43,.35)">
      <div class="right"><div class="t">üö´ ‡∏û‡∏ö‡πÉ‡∏ô Blacklist</div><span class="badge">BLOCK</span></div>
      <div class="item m">${bl.map(x=>`‚Ä¢ ${x.type} = ${x.value}\n  ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ${x.reason||"-"}\n  ‡πÇ‡∏î‡∏¢: ${x.by||"-"} (${x.createdAt||"-"})`).join("\n\n")}</div>
    </div>`;
  }

  html += `<div class="item">
    <div class="right"><div class="t">üìå ‡∏™‡∏£‡∏∏‡∏õ</div><span class="badge">${data.normalizedPhone ? "PHONE" : "ID"}</span></div>
    <div class="m">‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô: ${data.query}\n‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô: ${data.normalizedPhone||"-"}\n‡∏û‡∏ö participants: ${p.length}\n‡∏û‡∏ö bind: ${b ? "‡∏°‡∏µ" : "‡πÑ‡∏°‡πà‡∏°‡∏µ"}</div>
  </div>`;

  if(b){
    html += `<div class="item">
      <div class="right"><div class="t">üîó Bind</div><span class="badge">BIND</span></div>
      <div class="m">phone: ${b.phone}\ndeviceId: ${b.deviceId}\nfingerprint: ${b.fingerprint}\nua_key: ${b.ua_key}\nfirstSeen: ${b.firstSeenAt}\nlastSeen: ${b.lastSeenAt}\nnote: ${b.note||"-"}</div>
    </div>`;
  }

  if(p.length){
    html += `<div class="item">
      <div class="right"><div class="t">‚úÖ Participants</div><span class="badge">LIST</span></div>
      <div class="m">${p.slice(0,10).map(x=>`‚Ä¢ ${x.createdAt} | ${x.phone}\n  dev=${x.deviceId}\n  fp=${x.fingerprint}\n  ua=${x.ua_key}\n  status=${x.status||"-"}`).join("\n\n")}${p.length>10?`\n\n‚Ä¶ ‡∏≠‡∏µ‡∏Å ${p.length-10} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`:``}</div>
    </div>`;
  }

  box.innerHTML = html;

  // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Manage ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  if(data.normalizedPhone) $("unlockPhone").value = data.normalizedPhone;
  $("blValue").value = data.query;
}

function renderRecent(list){
  const box = $("recent");
  if(!list || !list.length){
    box.innerHTML = `<div class="item"><div class="t">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div></div>`;
    return;
  }
  box.innerHTML = list.map(x=>`
    <div class="item">
      <div class="right"><div class="t">üïí ${x.createdAt||"-"}</div><span class="badge">${x.status||"JOINED"}</span></div>
      <div class="m">‡πÄ‡∏ö‡∏≠‡∏£‡πå: ${x.phone}\ndeviceId: ${x.deviceId}\nfingerprint: ${x.fingerprint}\nua_key: ${x.ua_key}</div>
    </div>
  `).join("");
}

async function loadDashboard(){
  setPill("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶", true);
  try{
    const data = await new Promise((res, rej)=>{
      google.script.run.withSuccessHandler(res).withFailureHandler(rej).rrAdminDashboard();
    });
    $("stP").textContent  = data.counts.participants;
    $("stB").textContent  = data.counts.binds;
    $("stBL").textContent = data.counts.blacklist;
    renderRecent(data.recent || []);
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }catch(e){
    setPill("‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", false);
  }
}

$("btnSearch").addEventListener("click", async ()=>{
  clearMsg("msgSearch");
  const q = $("q").value.trim();
  if(!q){ showMsg("msgSearch","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤","err"); return; }
  setPill("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‚Ä¶", true);
  try{
    const data = await new Promise((res, rej)=>{
      google.script.run.withSuccessHandler(res).withFailureHandler(rej).rrAdminSearch(q);
    });
    if(!data.ok){ showMsg("msgSearch", data.msg||"‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "err"); return; }
    renderResult(data);
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }catch(e){
    showMsg("msgSearch","‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+(e.message||e),"err");
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }
});

$("btnClear").addEventListener("click", ()=>{
  $("q").value="";
  renderResult(null);
  clearMsg("msgSearch");
});

$("btnUnlock").addEventListener("click", async ()=>{
  clearMsg("msgManage");
  const phone = $("unlockPhone").value.trim();
  const reason = $("unlockReason").value.trim();
  if(!phone){ showMsg("msgManage","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å","err"); return; }
  if(!confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå ${phone} ?\n(‡∏à‡∏∞‡∏•‡∏ö participants + bind ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ)`)) return;

  setPill("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‚Ä¶", true);
  try{
    const out = await new Promise((res, rej)=>{
      google.script.run.withSuccessHandler(res).withFailureHandler(rej).rrAdminUnlockPhone(phone, reason);
    });
    showMsg("msgManage", out.msg || "‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", out.ok ? "ok":"err");
    await loadDashboard();
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }catch(e){
    showMsg("msgManage","‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+(e.message||e),"err");
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }
});

$("btnBLOn").addEventListener("click", async ()=>{
  clearMsg("msgManage");
  const type = $("blType").value;
  const value = $("blValue").value.trim();
  const reason = $("blReason").value.trim();
  if(!value){ showMsg("msgManage","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏ô","err"); return; }

  setPill("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏ö‡∏ô‚Ä¶", true);
  try{
    const out = await new Promise((res, rej)=>{
      google.script.run.withSuccessHandler(res).withFailureHandler(rej).rrAdminBlacklistOn(type, value, reason);
    });
    showMsg("msgManage", out.msg || "‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", out.ok ? "ok":"err");
    await loadDashboard();
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }catch(e){
    showMsg("msgManage","‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+(e.message||e),"err");
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }
});

$("btnBLOff").addEventListener("click", async ()=>{
  clearMsg("msgManage");
  const type = $("blType").value;
  const value = $("blValue").value.trim();
  if(!value){ showMsg("msgManage","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ô","err"); return; }

  setPill("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ô‚Ä¶", true);
  try{
    const out = await new Promise((res, rej)=>{
      google.script.run.withSuccessHandler(res).withFailureHandler(rej).rrAdminBlacklistOff(type, value);
    });
    showMsg("msgManage", out.msg || "‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", out.ok ? "ok":"err");
    await loadDashboard();
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }catch(e){
    showMsg("msgManage","‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+(e.message||e),"err");
    setPill("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", true);
  }
});

loadDashboard();
</script>
</body>
</html>
