<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ลงทะเบียนกิจกรรม</title>

<style>
  body{
    font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
    background:#0b0b0b;
    color:#fff;
    margin:0;
    padding:0;
  }
  .wrap{
    max-width:420px;
    margin:40px auto;
    background:#141414;
    border-radius:16px;
    padding:24px;
    box-shadow:0 0 30px rgba(0,0,0,.6);
  }
  h1{
    text-align:center;
    font-size:22px;
    margin-bottom:20px;
  }
  label{
    display:block;
    margin-bottom:6px;
    font-size:14px;
  }
  input{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid #333;
    background:#0f0f0f;
    color:#fff;
    margin-bottom:14px;
  }
  button{
    width:100%;
    padding:14px;
    border-radius:12px;
    border:none;
    background:#e10600;
    color:#fff;
    font-size:16px;
    cursor:pointer;
  }
  button:disabled{
    opacity:.6;
    cursor:not-allowed;
  }
  .msg{
    margin-top:14px;
    text-align:center;
    font-size:14px;
  }
</style>
</head>

<body>
  <div class="wrap">
    <h1>ลงทะเบียนเข้าร่วมกิจกรรม</h1>

    <label>เบอร์โทรศัพท์</label>
    <input id="phone" type="tel" placeholder="กรอกเบอร์โทร" maxlength="10">

    <button id="btn">ยืนยันเข้าร่วม</button>

    <div id="msg" class="msg"></div>
  </div>

<script>
/* =========================
   ตั้งค่า
========================= */
const ENDPOINT = "https://script.google.com/macros/s/AKfycbyNazYAmQyUxX2y721MMAoKcmDVp3tKkRTmyUKnpHgY9WA5_RzCM_bVcU6L7_NdNcB4/exec";

/* =========================
   DOM
========================= */
const phoneEl = document.getElementById("phone");
const btnEl   = document.getElementById("btn");
const msgEl   = document.getElementById("msg");

/* =========================
   ฟังก์ชัน
========================= */
function showMsg(text, ok=false){
  msgEl.textContent = text;
  msgEl.style.color = ok ? "#00ff99" : "#ff6666";
}

function validPhone(p){
  return /^0\d{9}$/.test(p);
}

/* =========================
   Submit
========================= */
btnEl.addEventListener("click", async ()=>{
  const phone = phoneEl.value.trim();

  if(!validPhone(phone)){
    showMsg("กรุณากรอกเบอร์โทรให้ถูกต้อง");
    return;
  }

  btnEl.disabled = true;
  showMsg("กำลังตรวจสอบข้อมูล...");

  try{
    const res = await fetch(ENDPOINT, {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify({ phone })
    });

    const data = await res.json();

    if(data.ok){
      showMsg(data.msg || "ลงทะเบียนสำเร็จ", true);
    }else{
      showMsg(data.msg || "ไม่สามารถทำรายการได้");
    }

  }catch(err){
    showMsg("ระบบขัดข้อง กรุณาลองใหม่");
  }finally{
    btnEl.disabled = false;
  }
});
</script>
</body>
</html>
