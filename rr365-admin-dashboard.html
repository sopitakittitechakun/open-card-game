<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡∏ó‡∏≤‡∏¢‡∏ú‡∏•‡∏ö‡∏≠‡∏• (‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô)</title>

  <style>
    :root{
      --bg:#0a0202;
      --txt:#ffecec;
      --muted:#ffb3b3;
      --line:rgba(255,60,60,.25);
      --shadow:0 18px 48px rgba(0,0,0,.65);
      --radius:18px;
      --accent:#ff2b2b;
      --accent2:#b80000;
      --okbg:rgba(255,140,140,.14);
      --okbd:rgba(255,140,140,.35);
      --errbg:rgba(255,50,50,.18);
      --errbd:rgba(255,50,50,.45);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      padding:26px;
      font-family:system-ui,-apple-system,"Segoe UI",Tahoma,sans-serif;
      color:var(--txt);
      background:
        radial-gradient(1100px 650px at 18% 10%, rgba(255,0,0,.25), transparent 60%),
        radial-gradient(1100px 650px at 82% 18%, rgba(255,0,0,.18), transparent 60%),
        radial-gradient(900px 520px at 50% 120%, rgba(255,0,0,.10), transparent 55%),
        var(--bg);
    }

    /* ‡πÇ‡∏´‡∏°‡∏î‡∏Ñ‡∏≠‡∏° 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå */
    .wrap{
      width:min(1180px, 100%);
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 900px){
      .wrap{grid-template-columns:1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .head{
      padding:18px 18px 14px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,43,43,.26), transparent);
      text-align:center;
    }

    /* ===== ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ß‡πá‡∏ö ===== */
    .web-logo{
      display:flex;
      justify-content:center;
      margin-bottom:10px;
    }
    .web-logo .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,60,60,.28);
      background: rgba(0,0,0,.14);
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
    }
    .web-logo img{
      max-width:180px;
      height:auto;
      display:block;
      filter: drop-shadow(0 0 18px rgba(255,0,0,.75));
    }
    /* ===================== */

    .title{
      font-weight:900;
      font-size:20px;
      letter-spacing:.2px;
      margin-top:2px;
    }
    .sub{
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
      margin-top:8px;
    }

    .matchbar{
      margin-top:14px;
      padding:14px;
      border-radius:16px;
      border:1px solid rgba(255,60,60,.28);
      background: rgba(0,0,0,.18);
    }

    .team-logos{
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      gap:14px;
      align-items:center;
    }
    .team{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      flex-direction:column;
      text-align:center;
    }
    .team img{
      width:90px;
      height:90px;
      object-fit:contain;
      border-radius:16px;
      padding:10px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,60,60,.35);
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
    }
    .team .name{
      font-size:12px;
      color: rgba(255,230,230,.90);
      max-width: 240px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .vs{
      font-weight:1000;
      letter-spacing:1px;
      color: rgba(255,200,200,.85);
      text-align:center;
      user-select:none;
      font-size:18px;
    }

    .body{ padding:18px; }

    label{
      display:block;
      margin:0 0 8px;
      font-size:13px;
      color:var(--muted);
    }

    input{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.22);
      color:var(--txt);
      outline:none;
      font-size:14px;
    }
    input::placeholder{color:rgba(255,200,200,.45)}
    input:focus{
      border-color: rgba(255,43,43,.85);
      box-shadow: 0 0 0 4px rgba(255,43,43,.28);
    }

    .scorebox{
      margin-top:10px;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      gap:10px;
      align-items:center;
      padding:12px;
      border-radius:14px;
      border:1px dashed rgba(255,43,43,.48);
      background: rgba(80,0,0,.28);
    }

    .hint{
      margin-top:10px;
      font-size:12px;
      color: rgba(255,220,220,.62);
      line-height:1.45;
    }

    .actions{
      display:flex;
      gap:10px;
      margin-top:14px;
      flex-wrap:wrap;
    }

    button{
      cursor:pointer;
      border:none;
      border-radius:14px;
      padding:12px 14px;
      font-weight:900;
      letter-spacing:.2px;
      font-size:14px;
    }
    .btn-primary{
      flex:1;
      min-width:200px;
      color:#fff;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
    }
    .btn-ghost{
      background: rgba(255,255,255,.06);
      color: var(--txt);
      border:1px solid var(--line);
    }
    button[disabled]{opacity:.55; cursor:not-allowed}

    .ok,.err{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
      margin-top:12px;
    }
    .ok{background:var(--okbg); border:1px solid var(--okbd)}
    .err{background:var(--errbg); border:1px solid var(--errbd)}

    .box{
      padding:16px;
      border-radius:var(--radius);
      border:1px solid var(--line);
      background: rgba(0,0,0,.22);
    }
    .box h3{
      margin:0 0 10px;
      font-size:14px;
      color: rgba(255,240,240,.95);
    }
    .kv{
      display:grid;
      grid-template-columns: 120px 1fr;
      gap:8px 12px;
      font-size:13px;
      color: rgba(255,240,240,.92);
    }
    .k{color: rgba(255,200,200,.72)}
    .copy{
      white-space:pre-wrap;
      user-select:text;
      font-size:13px;
      color: rgba(255,230,230,.92);
      line-height:1.55;
    }
  </style>
</head>

<body>

<!-- ================== ADMIN CONFIG (‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ================== -->
<script>
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbx1ZzQNUdVAWYmdfjlA1htlYy7MvNGy1-Hb-CGahrJI2Q-JMWELO_YBei5HM_11jZ5C/exec";

  const HOME_TEAM_NAME = "‡πÅ‡∏°‡∏ô‡∏¢‡∏π";
  const AWAY_TEAM_NAME = "‡πÅ‡∏°‡∏ô‡∏ã‡∏¥‡∏ï‡∏µ‡πâ";
  const ADMIN_CLOSE_TEXT = "‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 14:00 ‡∏ô.";

  const HOME_LOGO = "https://media.api-sports.io/football/teams/33.png";
  const AWAY_LOGO = "https://media.api-sports.io/football/teams/50.png";

  // ‚úÖ ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ß‡πá‡∏ö
  const WEB_LOGO_URL = "https://s.imgz.io/2025/12/15/17350205944e7ae9382775e78b.png";
</script>
<!-- ============================================================= -->

<main class="wrap">

  <section class="card">
    <div class="head">

      <!-- ‚úÖ ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ß‡πá‡∏ö -->
      <div class="web-logo">
        <div class="pill">
          <img id="webLogo" src="" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ß‡πá‡∏ö" loading="lazy"
               referrerpolicy="no-referrer"
               onerror="this.onerror=null; this.src='logo.png';" />
        </div>
      </div>

      <div class="title">‚öΩ ‡∏ó‡∏≤‡∏¢‡∏ú‡∏•‡∏ö‡∏≠‡∏•</div>
      <div class="sub">
        ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô: ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå ‚Üí ‡∏Å‡∏î ‚Äú‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‚Äù ‚Üí ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ó‡∏≤‡∏¢‡∏™‡∏Å‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á<br>
        <span id="closeText"></span>
      </div>

      <div class="matchbar">
        <div class="team-logos">
          <div class="team">
            <img id="homeLogo" src="" alt="‡∏ó‡∏µ‡∏°‡πÄ‡∏´‡∏¢‡πâ‡∏≤" referrerpolicy="no-referrer"
                 onerror="this.onerror=null; this.src='home.png';" />
            <div class="name" id="homeName">‚Äî</div>
          </div>

          <div class="vs">VS</div>

          <div class="team">
            <img id="awayLogo" src="" alt="‡∏ó‡∏µ‡∏°‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô" referrerpolicy="no-referrer"
                 onerror="this.onerror=null; this.src='away.png';" />
            <div class="name" id="awayName">‚Äî</div>
          </div>
        </div>

        <div class="sub" style="margin-top:10px">
          ‡∏Ñ‡∏π‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <b id="matchText">‚Äî</b>
        </div>
      </div>
    </div>

    <div class="body">
      <form id="predictForm" autocomplete="off">

        <div>
          <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
          <input id="username" placeholder="‡πÄ‡∏ä‡πà‡∏ô 096xxxxxxx" inputmode="numeric" required />
        </div>

        <div class="actions" style="margin-top:10px">
          <button class="btn-ghost" type="button" id="btnCheck">üîé ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</button>
          <button class="btn-ghost" type="button" id="btnFillDemo">‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
          <button class="btn-ghost" type="reset" id="btnReset">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>

        <div style="margin-top:12px">
          <label>‡∏ó‡∏≤‡∏¢‡∏™‡∏Å‡∏≠‡∏£‡πå</label>
          <div class="scorebox">
            <input id="homeScore" type="number" min="0" max="99" placeholder="‡πÄ‡∏´‡∏¢‡πâ‡∏≤" disabled required />
            <div class="vs" style="font-size:16px">VS</div>
            <input id="awayScore" type="number" min="0" max="99" placeholder="‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô" disabled required />
          </div>
          <div class="hint">* ‡∏ó‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß/‡∏ß‡∏±‡∏ô (‡∏•‡πá‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)</div>
        </div>

        <div class="actions">
          <button class="btn-primary" id="btnSend" type="submit" disabled>‚õî ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</button>
        </div>

        <div id="msg"></div>
      </form>
    </div>
  </section>

  <aside class="card">
    <div class="head">
      <div class="title" style="font-size:18px">üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢</div>
      <div class="sub">‡πÄ‡∏ä‡πá‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á + ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ</div>
    </div>

    <div class="body">
      <div class="box">
        <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
        <div class="kv">
          <div class="k">‡∏Ñ‡∏π‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</div><div id="pMatch">‚Äî</div>
          <div class="k">‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö:</div><div id="pClose">‚Äî</div>
        </div>
      </div>

      <div class="box" style="margin-top:12px">
        <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
        <div class="kv">
          <div class="k">‡∏¢‡∏π‡∏™:</div><div id="pUser">‚Äî</div>
          <div class="k">‡∏™‡∏Å‡∏≠‡∏£‡πå:</div><div id="pScore">‚Äî</div>
        </div>
      </div>

      <div class="box" style="margin-top:12px">
        <h3>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
        <div id="copyText" class="copy">‚Äî</div>
        <div class="actions" style="margin-top:10px">
          <button class="btn-ghost" type="button" id="btnCopy">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
        </div>
        <div id="copyMsg"></div>
      </div>
    </div>
  </aside>

</main>

<script>
  const $ = (id) => document.getElementById(id);

  const btnSend = $("btnSend");
  const btnCheck = $("btnCheck");
  const msg = $("msg");
  const copyMsg = $("copyMsg");

  function showAlert(type, text){
    msg.innerHTML = (type === "ok")
      ? `<div class="ok">‚úÖ ${text}</div>`
      : `<div class="err">‚ö†Ô∏è ${text}</div>`;
  }
  function showCopy(type, text){
    copyMsg.innerHTML = (type === "ok")
      ? `<div class="ok">üìã ${text}</div>`
      : `<div class="err">‚ö†Ô∏è ${text}</div>`;
    setTimeout(()=> copyMsg.innerHTML="", 2500);
  }

  function getDeviceId(){
    const key = "RR365_DEVICE_ID";
    let v = localStorage.getItem(key);
    if (!v) {
      v = (crypto && crypto.randomUUID) ? crypto.randomUUID()
        : ("dev_" + Math.random().toString(16).slice(2) + Date.now());
      localStorage.setItem(key, v);
    }
    return v;
  }
  const deviceId = getDeviceId();

  function isValidPhone(p){
    return /^0\d{8,9}$/.test(p);
  }

  function lockForever(text){
    btnSend.dataset.locked = "1";
    btnSend.disabled = true;
    btnSend.textContent = text;
    btnCheck.disabled = true;
    $("homeScore").disabled = true;
    $("awayScore").disabled = true;
  }

  function setScoreEnabled(on){
    $("homeScore").disabled = !on;
    $("awayScore").disabled = !on;
  }

  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤
  const match = `${HOME_TEAM_NAME} vs ${AWAY_TEAM_NAME}`;
  $("closeText").textContent = ADMIN_CLOSE_TEXT;
  $("matchText").textContent = match;

  $("homeName").textContent = HOME_TEAM_NAME;
  $("awayName").textContent = AWAY_TEAM_NAME;

  $("homeLogo").src = HOME_LOGO;
  $("awayLogo").src = AWAY_LOGO;

  // ‚úÖ ‡πÉ‡∏™‡πà‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ß‡πá‡∏ö
  $("webLogo").src = WEB_LOGO_URL;

  // ‡∏™‡∏£‡∏∏‡∏õ
  function renderPreview(){
    const user = $("username").value.trim() || "‚Äî";
    const hs = $("homeScore").value;
    const as = $("awayScore").value;
    const score = (hs !== "" && as !== "") ? `${hs}-${as}` : "‚Äî";

    $("pMatch").textContent = match;
    $("pClose").textContent = ADMIN_CLOSE_TEXT.replace("‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢:", "").trim();
    $("pUser").textContent = user;
    $("pScore").textContent = score;

    $("copyText").textContent =
`[‡∏ó‡∏≤‡∏¢‡∏ú‡∏•‡∏ö‡∏≠‡∏•]
‡∏Ñ‡∏π‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ${match}
${ADMIN_CLOSE_TEXT}
‡∏¢‡∏π‡∏™: ${user}
‡∏ó‡∏≤‡∏¢‡∏™‡∏Å‡∏≠‡∏£‡πå: ${score}`;
  }

  ["username","homeScore","awayScore"].forEach(id=>{
    $(id).addEventListener("input", renderPreview);
    $(id).addEventListener("change", renderPreview);
  });

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
  setScoreEnabled(false);
  btnSend.disabled = true;
  btnSend.textContent = "‚õî ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";
  renderPreview();

  // ‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
  $("btnFillDemo").addEventListener("click", ()=>{
    $("username").value = "0960000000";
    renderPreview();
    showAlert("ok","‡πÉ‡∏™‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
  });

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (action: check)
  btnCheck.addEventListener("click", async ()=>{
    if (btnSend.dataset.locked === "1") return;

    const username = $("username").value.trim();
    if (!isValidPhone(username)){
      return showAlert("err","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô 096xxxxxxx)");
    }

    btnCheck.disabled = true;
    btnCheck.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå...";

    try{
      const res = await fetch(WEB_APP_URL, {
        method: "POST",
        body: JSON.stringify({
          action: "check",
          username,
          deviceId,
          userAgent: navigator.userAgent
        })
      });
      const data = await res.json();

      if (data.ok){
        showAlert("ok","‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡πâ‡∏ß ‚úÖ ‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡∏Å‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
        setScoreEnabled(true);
        btnSend.disabled = false;
        btnSend.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢";
      } else {
        showAlert("err", data.msg || "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç");

        const m = String(data.msg || "");
        if (m.includes("‡∏ó‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß") || m.includes("‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ")){
          lockForever("‡∏ó‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ");
        } else {
          setScoreEnabled(false);
          btnSend.disabled = true;
          btnSend.textContent = "‚õî ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";
        }
      }
    } catch (e){
      showAlert("err","‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Web App / ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï");
    } finally {
      btnCheck.disabled = false;
      btnCheck.textContent = "üîé ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";
    }
  });

  // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢ (action: submit)
  $("predictForm").addEventListener("submit", async (e)=>{
    e.preventDefault();
    if (btnSend.dataset.locked === "1") return;

    const username = $("username").value.trim();
    const homeScore = $("homeScore").value;
    const awayScore = $("awayScore").value;

    if (!isValidPhone(username)){
      return showAlert("err","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô 096xxxxxxx)");
    }
    if (homeScore === "" || awayScore === ""){
      return showAlert("err","‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡∏Å‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
    }

    btnSend.disabled = true;
    btnSend.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...";

    try{
      const res = await fetch(WEB_APP_URL, {
        method: "POST",
        body: JSON.stringify({
          action: "submit",
          username,
          homeScore,
          awayScore,
          deviceId,
          userAgent: navigator.userAgent
        })
      });
      const data = await res.json();

      if (data.ok){
        showAlert("ok","‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ (‡∏ó‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß/‡∏ß‡∏±‡∏ô)");
        lockForever("‡∏ó‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ");
        $("predictForm").reset();
        renderPreview();
      } else {
        const m = String(data.msg || "‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        showAlert("err", m);

        if (m.includes("‡∏ó‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß") || m.includes("‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ")){
          lockForever("‡∏ó‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ");
        } else if (m.includes("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå") || m.includes("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå") || m.includes("‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô")){
          setScoreEnabled(false);
          btnSend.disabled = true;
          btnSend.textContent = "‚õî ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";
        } else {
          btnSend.disabled = false;
          btnSend.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢";
        }
      }
    } catch (err){
      showAlert("err","‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Web App / Deploy / ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï");
      btnSend.disabled = false;
      btnSend.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡∏≤‡∏¢";
    }
  });

  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
  $("btnReset").addEventListener("click", ()=>{
    setTimeout(()=>{
      renderPreview();
      if (btnSend.dataset.locked !== "1"){
        setScoreEnabled(false);
        btnSend.disabled = true;
        btnSend.textContent = "‚õî ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";
      }
    }, 0);
  });

  // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
  $("btnCopy").addEventListener("click", async ()=>{
    try{
      await navigator.clipboard.writeText($("copyText").textContent);
      showCopy("ok","‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
    }catch(e){
      showCopy("err","‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    }
  });
</script>

</body>
</html>
