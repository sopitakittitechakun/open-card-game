<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° | ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î</title>
<meta name="color-scheme" content="dark"/>
<style>
  :root{
    --bg0:#070102; --bg1:#0f0204; --card:rgba(255,255,255,.06); --line:rgba(255,80,80,.20);
    --txt:#ffecec; --muted:#ffb6b6; --accent:#ff2b2b; --accent2:#b80000;
    --ok:#36d399; --warn:#fbbf24; --bad:#ff5a5f; --shadow:0 22px 60px rgba(0,0,0,.65); --radius:22px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:system-ui,-apple-system,"Segoe UI",Tahoma,sans-serif;
    color:var(--txt);
    background:
      radial-gradient(1200px 700px at 18% 8%, rgba(255,60,60,.20), transparent 60%),
      radial-gradient(900px 600px at 85% 12%, rgba(255,120,120,.10), transparent 55%),
      radial-gradient(900px 700px at 50% 105%, rgba(255,40,40,.16), transparent 60%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
    overflow-x:hidden;
    -webkit-tap-highlight-color: transparent;
  }
  .wrap{max-width:720px;margin:0 auto;padding:22px 14px 110px}
  .hero{
    border:1px solid var(--line); border-radius:28px; padding:16px;
    background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
    box-shadow:var(--shadow); position:sticky; top:12px; z-index:5; backdrop-filter: blur(10px);
  }
  .top{display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;}
  .brand{display:flex; align-items:center; gap:12px;}
  .logo{width:46px;height:46px;border-radius:16px;background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%),linear-gradient(135deg,var(--accent),var(--accent2));border:1px solid rgba(255,255,255,.14);box-shadow:0 12px 30px rgba(255,0,0,.25)}
  .title{margin:0;font-size:16px;font-weight:900;line-height:1.2}
  .sub{margin-top:2px;font-size:12px;color:var(--muted);line-height:1.35}
  .status{display:flex;gap:10px;align-items:center;padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.25);min-height:40px}
  .dot{width:10px;height:10px;border-radius:999px;background:rgba(255,255,255,.25);box-shadow:0 0 0 4px rgba(255,255,255,.06)}
  .dot.ok{background:var(--ok);box-shadow:0 0 0 4px rgba(54,211,153,.15)}
  .dot.warn{background:var(--warn);box-shadow:0 0 0 4px rgba(251,191,36,.12)}
  .dot.bad{background:var(--bad);box-shadow:0 0 0 4px rgba(255,90,95,.14)}
  .status b{font-size:12px}
  .status span{font-size:12px;color:var(--muted)}
  .card{margin-top:14px;border:1px solid var(--line);border-radius:var(--radius);background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));box-shadow:0 18px 46px rgba(0,0,0,.55);overflow:hidden}
  .card .hd{padding:14px 16px;border-bottom:1px solid var(--line);background:linear-gradient(90deg, rgba(255,40,40,.12), transparent);display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
  .card .hd .ttl{font-weight:900;font-size:14px;display:flex;align-items:center;gap:10px}
  .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.25);color:var(--muted);white-space:nowrap}
  .card .bd{padding:16px}
  label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
  input{width:100%;padding:12px 12px;border-radius:16px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.35);color:var(--txt);font-size:16px;outline:none}
  input:focus{border-color:rgba(255,80,80,.55);box-shadow:0 0 0 4px rgba(255,40,40,.15)}
  .msg{margin-top:12px;padding:12px 12px;border-radius:16px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.25);white-space:pre-line;display:none;line-height:1.55}
  .msg.ok{border-color:rgba(54,211,153,.35)} .msg.err{border-color:rgba(255,90,95,.45)} .msg.info{border-color:rgba(255,80,80,.22)}
  .bar{position:fixed;left:0;right:0;bottom:0;padding:12px 14px;background:linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.65) 25%, rgba(0,0,0,.85));backdrop-filter: blur(8px);z-index:50;pointer-events:none}
  .barInner{max-width:720px;margin:0 auto;display:flex;gap:10px;pointer-events:auto}
  button{border:0;cursor:pointer;padding:12px 14px;border-radius:16px;font-weight:900;font-size:15px;color:#fff;transition:.15s;flex:1;touch-action:manipulation}
  .btnMain{background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 14px 30px rgba(255,0,0,.25)}
  .btnAlt{background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.14);color:var(--txt)}
  button:disabled{opacity:.55;cursor:not-allowed}
  .copyWrap{display:none;gap:10px;align-items:center;margin-top:12px}
  .codeBox{flex:1;padding:10px 12px;border-radius:14px;border:1px dashed rgba(255,255,255,.18);background:rgba(0,0,0,.25);font-weight:900}
  .btnCopy{padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.10);font-weight:900}
  .btnCopy.copied{border-color:rgba(54,211,153,.35)}
</style>
</head>
<body>

<div class="wrap">
  <div class="hero">
    <div class="top">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <div class="title">‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° | ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î</div>
          <div class="sub">‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î</div>
        </div>
      </div>
      <div class="status">
        <div class="dot warn" id="dot"></div>
        <div>
          <b id="stTitle">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</b><br/>
          <span id="stSub">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="hd">
      <div class="ttl">üìå ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
      <span class="pill">JSONP ‚úì</span>
    </div>
    <div class="bd">
      <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label>
      <input id="phone" inputmode="numeric" placeholder="06xxxxxxxx" maxlength="12"/>

      <div id="captchaWrap" style="display:none;">
        <label id="captchaQ">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</label>
        <input id="captchaA" inputmode="numeric" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö"/>
      </div>

      <div class="msg info" id="msg"></div>

      <div class="copyWrap" id="copyWrap">
        <div class="codeBox" id="promoCode">-</div>
        <button class="btnCopy" id="btnCopy" type="button">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
      </div>
    </div>
  </div>
</div>

<div class="bar">
  <div class="barInner">
    <button class="btnAlt" id="btnCheck" type="button">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</button>
    <button class="btnMain" id="btnJoin" type="button" disabled>üìù ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</button>
    <button class="btnAlt" id="btnPoll" type="button">üîé ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î</button>
  </div>
</div>

<script>
/* ====== ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå /exec ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ====== */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyYkkY_ZJLAj03XaF0ycIQO5CLi5ntekJhwmot5D9TBZldjiPqLUDVGHXJg1s6YlbD1/exec";

/* ============ UI helpers ============ */
const $ = (id)=>document.getElementById(id);
const $phone=$("phone"), $msg=$("msg"), $dot=$("dot"), $stTitle=$("stTitle"), $stSub=$("stSub");
const $btnCheck=$("btnCheck"), $btnJoin=$("btnJoin"), $btnPoll=$("btnPoll");
const $captchaWrap=$("captchaWrap"), $captchaQ=$("captchaQ"), $captchaA=$("captchaA");
const $copyWrap=$("copyWrap"), $promoCode=$("promoCode"), $btnCopy=$("btnCopy");

function setStatus(kind, title, sub){
  $dot.className = "dot " + (kind||"warn");
  $stTitle.textContent = title || "";
  $stSub.textContent = sub || "";
}
function show(text, kind){
  $msg.style.display="block";
  $msg.className = "msg " + (kind||"info");
  $msg.textContent = text || "";
}
function hideMsg(){ $msg.style.display="none"; }
function showCaptcha(q){
  $captchaWrap.style.display="block";
  $captchaQ.textContent = q || "‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô";
}
function hideCaptcha(){
  $captchaWrap.style.display="none";
  $captchaA.value="";
}
function showCopy(code){
  $promoCode.textContent = code || "-";
  $copyWrap.style.display="flex";
}
function hideCopy(){
  $promoCode.textContent="-";
  $copyWrap.style.display="none";
}

function bindTap(el, fn){
  el.addEventListener("click", fn, { passive:true });
  el.addEventListener("touchend", (e)=>{ e.preventDefault(); fn(e); }, { passive:false });
}

/* ============ identifiers ============ */
function normalizePhone(x){
  const s=String(x||"").replace(/[^\d‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô]/g,"");
  const th="‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô";
  let t=s;
  for(let i=0;i<th.length;i++) t=t.replaceAll(th[i], String(i));
  let p=t.replace(/\D/g,"");
  if(p.startsWith("0066")) p=p.slice(2);
  if(p.startsWith("66")) p="0"+p.slice(2);
  if(!p.startsWith("0") && p.length===9) p="0"+p;
  if(!/^0[689]\d{8}$/.test(p)) return "";
  return p;
}
function getOrCreateDeviceId(){
  const k="rr365_device_id";
  let v=localStorage.getItem(k);
  if(!v){
    v="d_"+Math.random().toString(36).slice(2)+Date.now().toString(36);
    localStorage.setItem(k,v);
  }
  return v;
}
function getUaKey(){
  const k="rr365_ua_key";
  let v=localStorage.getItem(k);
  if(!v){
    v="u_"+Math.random().toString(36).slice(2);
    localStorage.setItem(k,v);
  }
  return v;
}
function getFingerprint(){
  // fingerprint ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≤‡πÜ (‡∏û‡∏≠‡∏ú‡∏π‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á) ‚Äî ‡∏ñ‡πâ‡∏≤‡∏û‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ
  const k="rr365_fp";
  let v=localStorage.getItem(k);
  if(!v){
    const seed = [
      navigator.userAgent,
      screen.width+"x"+screen.height,
      Intl.DateTimeFormat().resolvedOptions().timeZone || "",
      navigator.language || ""
    ].join("|");
    v="fp_"+btoa(unescape(encodeURIComponent(seed))).slice(0,40);
    localStorage.setItem(k,v);
  }
  return v;
}

/* ============ JSONP ============ */
function jsonpRequest(params, timeoutMs=12000){
  return new Promise((resolve,reject)=>{
    if(!/\/exec(\?|$)/.test(SCRIPT_URL)) return reject(new Error("SCRIPT_URL_NOT_EXEC"));
    const cbName="cb_"+Math.random().toString(36).slice(2);
    params.jsonp="1";
    params.callback=cbName;
    params._ts=Date.now();

    const url = SCRIPT_URL + "?" + new URLSearchParams(params).toString();
    const script=document.createElement("script");
    script.src=url;
    script.async=true;

    const t=setTimeout(()=>{ cleanup(); reject(new Error("TIMEOUT")); }, timeoutMs);
    window[cbName]=(data)=>{ clearTimeout(t); cleanup(); resolve(data); };
    script.onerror=()=>{ clearTimeout(t); cleanup(); reject(new Error("SCRIPT_LOAD_ERROR")); };

    function cleanup(){
      try{ delete window[cbName]; }catch(e){ window[cbName]=undefined; }
      if(script && script.parentNode) script.parentNode.removeChild(script);
    }
    document.body.appendChild(script);
  });
}

/* ============ PoW (client) ============ */
async function sha256hex(text){
  const enc=new TextEncoder().encode(text);
  const buf=await crypto.subtle.digest("SHA-256", enc);
  const arr=Array.from(new Uint8Array(buf));
  return arr.map(b=>b.toString(16).padStart(2,"0")).join("");
}
async function solvePow(phone, serverNonce, prefix){
  const powNonce="pn_"+Math.random().toString(36).slice(2)+Date.now().toString(36);
  let sol=0;
  while(sol<200000){
    const key=[phone, serverNonce, powNonce, String(sol)].join("|");
    const hex=await sha256hex(key);
    if(hex.startsWith(prefix)) return { pow_nonce:powNonce, pow_sol:String(sol) };
    sol++;
    if(sol%800===0) await new Promise(r=>setTimeout(r,0));
  }
  throw new Error("POW_FAIL");
}

/* ============ session ============ */
let SAVED = { token:"", nonce:"", issued_at:0, captcha_id:"", captcha_q:"", pow_prefix:"0000", min_delay_ms:6000, max_delay_ms:45000 };
let READY_AT = 0;
let READY_TIMER = null;

function resetSession(){
  SAVED = { token:"", nonce:"", issued_at:0, captcha_id:"", captcha_q:"", pow_prefix:"0000", min_delay_ms:6000, max_delay_ms:45000 };
  READY_AT = 0;
  if(READY_TIMER){ clearInterval(READY_TIMER); READY_TIMER=null; }
}
function startCountdown(){
  READY_AT = Date.now() + (SAVED.min_delay_ms||6000);
  if(READY_TIMER) clearInterval(READY_TIMER);
  READY_TIMER=setInterval(()=>{
    const left = Math.ceil((READY_AT - Date.now())/1000);
    if(left<=0){
      clearInterval(READY_TIMER); READY_TIMER=null;
      $btnJoin.disabled=false;
      setStatus("ok","‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô","‡∏Å‡∏î ‚Äú‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‚Äù ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
    }else{
      $btnJoin.disabled=true;
      setStatus("warn","‡∏£‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏≠‡∏µ‡∏Å ${left} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`);
    }
  }, 300);
}

/* ============ request wrapper ============ */
async function request(action){
  hideMsg();
  const p = normalizePhone($phone.value);
  if(!p){ show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (06/08/09 10 ‡∏´‡∏•‡∏±‡∏Å)","err"); return null; }

  const payload = {
    action, phone:p,
    deviceId:getOrCreateDeviceId(),
    fingerprint:getFingerprint(),
    ua_key:getUaKey(),
    userAgent:navigator.userAgent
  };

  if(action==="register"){
    if(!SAVED.token || !SAVED.nonce || !SAVED.issued_at){
      show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°","err");
      return null;
    }
    if(Date.now() < READY_AT){
      const left = Math.ceil((READY_AT - Date.now())/1000);
      show(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏≠‡∏µ‡∏Å ${left} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ö‡∏≠‡∏ó)`,"err");
      return null;
    }
    if(Date.now() - SAVED.issued_at > SAVED.max_delay_ms){
      show("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á","err");
      return null;
    }
    const capA = ($captchaA.value||"").trim();
    if(!capA){
      show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°","err");
      return null;
    }

    show("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ö‡∏≠‡∏ó)","ok");
    const pow = await solvePow(p, SAVED.nonce, SAVED.pow_prefix || "0000").catch(()=>null);
    if(!pow){
      show("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ö‡∏≠‡∏ó)","err");
      return null;
    }
    payload.token = SAVED.token;
    payload.nonce = SAVED.nonce;
    payload.issued_at = SAVED.issued_at;
    payload.captcha_id = SAVED.captcha_id;
    payload.captcha_a  = capA;
    payload.pow_nonce  = pow.pow_nonce;
    payload.pow_sol    = pow.pow_sol;
  }

  return await jsonpRequest(payload);
}

/* ============ events ============ */
bindTap($btnCheck, async ()=>{
  resetSession();
  hideCopy(); hideCaptcha(); hideMsg();
  setStatus("warn","‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö","‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...");

  const data = await request("check").catch(()=>null);
  if(!data){ setStatus("bad","‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå /exec ‡πÅ‡∏•‡∏∞ Deploy"); show("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err"); return; }
  if(!data.ok){ setStatus("bad","‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"); show(data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","err"); return; }

  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÑ‡∏õ poll_code
  if(data.exists){
    setStatus("warn","‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß","‡∏Å‡∏î ‚Äú‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‚Äù");
    show(data.msg || "‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î", "ok");
    return;
  }

  if(data.device_used){
    setStatus("bad","‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î","‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ");
    show(data.msg||"‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î","err");
    return;
  }

  // store session
  SAVED.token = data.token || "";
  SAVED.nonce = data.nonce || "";
  SAVED.issued_at = Number(data.issued_at||0);
  SAVED.captcha_id = data.captcha_id || "";
  SAVED.captcha_q  = data.captcha_q || "";
  SAVED.pow_prefix = data.pow_prefix || "0000";
  SAVED.min_delay_ms = Number(data.min_delay_ms||6000);
  SAVED.max_delay_ms = Number(data.max_delay_ms||45000);

  showCaptcha(SAVED.captcha_q);
  show(data.msg || "‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß", "ok");
  startCountdown();
});

bindTap($btnJoin, async ()=>{
  hideCopy(); hideMsg();
  setStatus("warn","‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°","‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...");

  const data = await request("register").catch(()=>null);
  if(!data){ setStatus("bad","‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"); show("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err"); return; }
  if(!data.ok){ setStatus("bad","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"); show(data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","err"); return; }

  if(data.pending){
    setStatus("warn","‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÅ‡∏•‡πâ‡∏ß","‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥");
    show("‚è≥ ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!\n‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥\n\nüëâ ‡πÉ‡∏´‡πâ‡∏Å‡∏î ‚Äú‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "ok");
    resetSession();
    return;
  }

  // fallback
  setStatus("ok","‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î");
  show(data.msg || "‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "ok");
  resetSession();
});

bindTap($btnPoll, async ()=>{
  hideCopy(); hideMsg();
  setStatus("warn","‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞","‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...");

  const data = await request("poll_code").catch(()=>null);
  if(!data){ setStatus("bad","‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà/‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Deploy"); show("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err"); return; }
  if(!data.ok){ setStatus("bad","‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", data.msg||""); show(data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","err"); return; }

  if(data.status==="PENDING"){
    setStatus("warn","‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥","‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö");
    show("‚è≥ ‡∏¢‡∏±‡∏á‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡πà‡∏∞\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà", "ok");
    return;
  }
  if(data.status==="APPROVED"){
    const code=(data.promo_code||"").trim();
    if(!code || code==="NO_CODE"){
      setStatus("bad","‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏°‡∏î","‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô");
      show("‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏°‡∏î\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô", "err");
      return;
    }
    setStatus("ok","‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß","‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
    show("üéâ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß! ‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: " + code, "ok");
    showCopy(code);
    return;
  }
  if(data.status==="REJECTED"){
    setStatus("bad","‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥","‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô");
    show("‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô", "err");
    return;
  }
  if(data.status==="USED"){
    setStatus("bad","‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß","‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏ã‡πâ‡∏≥");
    show("‚ö†Ô∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß", "err");
    return;
  }

  show("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...", "ok");
});

/* copy */
bindTap($btnCopy, async ()=>{
  try{
    const txt = ($promoCode.textContent||"").trim();
    if(!txt) return;
    if(navigator.clipboard && navigator.clipboard.writeText){
      await navigator.clipboard.writeText(txt);
    }else{
      const ta=document.createElement("textarea");
      ta.value=txt; ta.style.position="fixed"; ta.style.left="-9999px";
      document.body.appendChild(ta); ta.focus(); ta.select();
      document.execCommand("copy");
      document.body.removeChild(ta);
    }
    $btnCopy.textContent="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì";
    $btnCopy.classList.add("copied");
    setTimeout(()=>{ $btnCopy.textContent="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å"; $btnCopy.classList.remove("copied"); }, 1500);
  }catch(_){
    alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á");
  }
});
</script>
</body>
</html>
