<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{font-family:system-ui;background:#0b0b0b;color:#fff;margin:0}
.wrap{padding:14px}
.card{background:#141414;border-radius:16px;padding:12px;margin-bottom:12px}
h2{margin:0 0 6px}
input,button{width:100%;padding:10px;border-radius:10px;border:0;margin-top:6px}
button{background:#ff2b2b;color:#fff;font-weight:700;cursor:pointer}
.list{white-space:pre-line;font-size:12px;opacity:.9}
</style>
</head>
<body>
<div class="wrap">

<div class="card">
  <h2>ğŸ›ï¸ RR365 Admin</h2>
  <div id="stat">à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”â€¦</div>
</div>

<div class="card">
  <h2>ğŸ” à¸„à¹‰à¸™à¸«à¸²</h2>
  <input id="q" placeholder="à¹€à¸šà¸­à¸£à¹Œ / deviceId / fp / ua">
  <button onclick="search()">à¸„à¹‰à¸™à¸«à¸²</button>
  <div id="result" class="list"></div>
</div>

<div class="card">
  <h2>ğŸ”“ à¸›à¸¥à¸”à¸¥à¹‡à¸­à¸à¹€à¸šà¸­à¸£à¹Œ</h2>
  <input id="unlock" placeholder="061xxxxxxx">
  <button onclick="unlock()">à¸›à¸¥à¸”à¸¥à¹‡à¸­à¸</button>
  <div id="msg"></div>
</div>

</div>

<script>
function load(){
  google.script.run.withSuccessHandler(d=>{
    document.getElementById("stat").innerText=
      `à¸œà¸¹à¹‰à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡ ${d.counts.participants} | à¸œà¸¹à¸à¸­à¸¸à¸›à¸à¸£à¸“à¹Œ ${d.counts.binds}`;
  }).adminDashboard();
}

function search(){
  const q=document.getElementById("q").value;
  google.script.run.withSuccessHandler(d=>{
    document.getElementById("result").innerText=
      JSON.stringify(d,null,2);
  }).adminSearch(q);
}

function unlock(){
  const p=document.getElementById("unlock").value;
  google.script.run.withSuccessHandler(d=>{
    document.getElementById("msg").innerText=d.msg;
    load();
  }).adminUnlock(p);
}

load();
</script>
</body>
</html>
