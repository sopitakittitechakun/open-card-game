<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° | ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</title>
<meta name="color-scheme" content="dark"/>
<style>
  :root{
    --bg:#0b0b0b; --card:#141414; --line:rgba(255,255,255,.12);
    --txt:#fff; --muted:#cfcfcf;
    --accent:#ff2b2b; --accent2:#b80000;
    --ok:#36d399; --bad:#ff5a5f;
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;padding:24px;
    font-family:system-ui,-apple-system,"Segoe UI",Tahoma,sans-serif;
    background:radial-gradient(900px 500px at 50% -10%, rgba(255,60,60,.15), transparent 60%), var(--bg);
    color:var(--txt);
  }
  .card{
    max-width:560px;margin:0 auto;
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border:1px solid var(--line); border-radius:24px; padding:18px;
    box-shadow:0 20px 50px rgba(0,0,0,.6);
  }
  h1{font-size:20px;margin:0 0 6px}
  p{margin:0 0 14px;color:var(--muted);line-height:1.6}
  label{display:block;margin:10px 0 6px;color:var(--muted)}
  input{
    width:100%;padding:12px 14px;border-radius:14px;
    border:1px solid var(--line);background:#0f0f0f;color:#fff;font-size:16px;
  }
  .row{display:flex;gap:10px;margin-top:12px}
  button{
    flex:1;padding:12px 14px;border-radius:14px;border:0;
    font-size:16px;font-weight:800;color:#fff;cursor:pointer;
  }
  .btnAlt{background:#2a2a2a}
  .btnMain{background:linear-gradient(135deg,var(--accent),var(--accent2))}
  button:disabled{opacity:.55;cursor:not-allowed}
  .msg{
    margin-top:12px;padding:12px;border-radius:14px;
    border:1px solid var(--line);background:rgba(0,0,0,.25);
    white-space:pre-line;display:none;line-height:1.6;
  }
  .ok{border-color:rgba(54,211,153,.4)}
  .err{border-color:rgba(255,90,95,.45)}
  .hint{font-size:12px;color:#bfbfbf;margin-top:10px;line-height:1.6}
  .linkBox{
    margin-top:10px;padding:12px;border-radius:14px;
    border:1px dashed rgba(255,255,255,.25);background:rgba(0,0,0,.25);
  }
  .linkBox a{color:#7dd3fc;text-decoration:none;font-weight:800}
</style>
</head>
<body>

<div class="card">
  <h1>üìå ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° & ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î</h1>
  <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ 1 ‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏ï‡πà‡∏≠ 1 ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</p>

  <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
  <input id="phone" inputmode="numeric" placeholder="‡πÄ‡∏ä‡πà‡∏ô 0611111111"/>

  <div class="row">
    <button id="btnCheck" class="btnAlt" type="button">‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</button>
    <button id="btnJoin" class="btnMain" type="button" disabled>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</button>
  </div>

  <div id="msg" class="msg"></div>

  <div class="hint">
    *‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡πÑ‡∏õ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ü‡∏£‡∏µ‡∏ï‡∏≤‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
  </div>

  <div class="linkBox">
    üëâ ‡∏Å‡∏£‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ü‡∏£‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà:<br>
    <a href="https://rumruay365.uk/events/free-credit" target="_blank">
      https://rumruay365.uk/events/free-credit
    </a>
  </div>
</div>

<script>
/* ================= CONFIG ================= */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwF6-h_Ip_gJHDbigip7x3oc8fDAHcwcn814k4ufXn4hlJ_lMDdhRsqYM7b40G6lWGLeg/exec"; // üî¥ ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå .../exec ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const DEVICE_ID_KEY = "rr365_device_id";

/* ================= STATE ================= */
let SAVED_TOKEN = "";
let TOKEN_EXPIRES_AT = 0;

/* ================= ELS ================= */
const $phone = document.getElementById("phone");
const $btnCheck = document.getElementById("btnCheck");
const $btnJoin  = document.getElementById("btnJoin");
const $msg = document.getElementById("msg");

/* ================= UI ================= */
function show(text, type="ok"){
  $msg.style.display="block";
  $msg.className="msg " + (type==="err"?"err":"ok");
  $msg.textContent=text;
}
function hideMsg(){ $msg.style.display="none"; $msg.textContent=""; }

/* ================= HELPERS ================= */
function normalizePhone(v){
  let s=String(v||"").trim();
  const th="‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô";
  for(let i=0;i<th.length;i++) s=s.replace(new RegExp(th[i],"g"),String(i));
  let p=s.replace(/\D/g,"");
  if(p.startsWith("0066")) p=p.slice(2);
  if(p.startsWith("66")) p="0"+p.slice(2);
  if(!p.startsWith("0") && p.length===9) p="0"+p;
  if(!/^0[689]\d{8}$/.test(p)) return "";
  return p;
}
function getOrCreateDeviceId(){
  let id=localStorage.getItem(DEVICE_ID_KEY);
  if(!id){ id="dev_"+Math.random().toString(36).slice(2)+Date.now().toString(36); localStorage.setItem(DEVICE_ID_KEY,id); }
  return id;
}
function getFingerprint(){
  const data=[screen.width,screen.height,devicePixelRatio,navigator.language||"",navigator.platform||""].join("|");
  let h=0; for(let i=0;i<data.length;i++){ h=((h<<5)-h)+data.charCodeAt(i); h|=0; }
  return "fp_"+Math.abs(h);
}
function getUaKey(){
  const ua=navigator.userAgent||"";
  let h=0; for(let i=0;i<ua.length;i++){ h=((h<<5)-h)+ua.charCodeAt(i); h|=0; }
  return "ua_"+Math.abs(h);
}

/* ================= JSONP ================= */
function jsonpRequest(params){
  return new Promise((resolve,reject)=>{
    if(!/\/exec(\?|$)/.test(SCRIPT_URL)) return reject(new Error("BAD_EXEC_URL"));
    const cb="cb_"+Math.random().toString(36).slice(2);
    params.jsonp="1"; params.callback=cb; params._ts=Date.now();
    const s=document.createElement("script");
    s.src=SCRIPT_URL+"?"+new URLSearchParams(params).toString();
    window[cb]=(d)=>{ cleanup(); resolve(d); };
    s.onerror=()=>{ cleanup(); reject(new Error("LOAD_ERR")); };
    function cleanup(){ try{delete window[cb];}catch(_){} if(s.parentNode) s.parentNode.removeChild(s); }
    document.body.appendChild(s);
  });
}

/* ================= REQUEST ================= */
async function request(action){
  hideMsg();
  const p=normalizePhone($phone.value);
  if(!p){ show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","err"); return null; }
  const payload={
    action, phone:p,
    deviceId:getOrCreateDeviceId(),
    fingerprint:getFingerprint(),
    ua_key:getUaKey(),
    userAgent:navigator.userAgent
  };
  if(action==="register"){
    if(!SAVED_TOKEN || Date.now()>=TOKEN_EXPIRES_AT){
      show("TOKEN ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡∏°‡πà","err"); return null;
    }
    payload.token=SAVED_TOKEN;
  }
  return await jsonpRequest(payload);
}

/* ================= EVENTS ================= */
$btnCheck.addEventListener("click", async ()=>{
  $btnCheck.disabled=true; $btnJoin.disabled=true;
  SAVED_TOKEN=""; TOKEN_EXPIRES_AT=0;
  const data=await request("check").catch(()=>null);
  $btnCheck.disabled=false;
  if(!data){ show("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err"); return; }
  if(!data.ok){ show(data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","err"); return; }
  if(data.exists){ show(data.msg||"‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Ñ‡∏¢‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß","err"); return; }
  if(data.device_used){ show(data.msg||"‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏¢‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß","err"); return; }
  if(data.token){
    SAVED_TOKEN=data.token;
    TOKEN_EXPIRES_AT=Date.now()+((data.token_ttl_sec||120)*1000);
  }
  show("‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î","ok");
  $btnJoin.disabled=false;
});

$btnJoin.addEventListener("click", async ()=>{
  $btnCheck.disabled=true; $btnJoin.disabled=true;
  const data=await request("register").catch(()=>null);
  $btnCheck.disabled=false;
  if(!data){ show("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err"); return; }
  if(!data.ok){ show(data.msg||"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","err"); return; }
  if(data.registered){
    const codeLine=data.promo_code?("\nüéÅ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: "+data.promo_code):"";
    show(
      "üéâ ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"+codeLine+
      "\n\nüëâ ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ü‡∏£‡∏µ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 38,888 ‡∏ö‡∏≤‡∏ó"+
      "\n‡∏ó‡∏≥‡∏¢‡∏≠‡∏î 10 ‡πÄ‡∏ó‡πà‡∏≤ ‡∏ñ‡∏≠‡∏ô‡πÑ‡∏î‡πâ 10 ‡πÄ‡∏ó‡πà‡∏≤",
      "ok"
    );
    SAVED_TOKEN=""; TOKEN_EXPIRES_AT=0;
  }else{
    show(data.msg||"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ","err");
  }
});
</script>
</body>
</html>
