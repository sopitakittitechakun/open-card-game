<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà | ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏∏‡πà‡∏°</title>
<meta name="color-scheme" content="dark"/>

<style>
:root{
  --bg:#0b0b0b;
  --card:#141414;
  --line:rgba(255,255,255,.12);
  --txt:#fff;
  --muted:#cfcfcf;

  --accent:#ff2b2b;
  --accent2:#b80000;

  --ok:#36d399;
  --bad:#ff5a5f;

  --radius:24px;
  --radius2:16px;

  --shadow: 0 22px 60px rgba(0,0,0,.70);
  --shadow2: 0 14px 40px rgba(0,0,0,.55);

  --glow: 0 0 0 1px rgba(255,255,255,.10), 0 0 30px rgba(255,43,43,.18);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  padding:24px;
  font-family:system-ui,-apple-system,"Segoe UI",Tahoma,sans-serif;
  color:var(--txt);
  background:
    radial-gradient(900px 540px at 50% -10%, rgba(255,60,60,.16), transparent 60%),
    radial-gradient(900px 540px at 20% 110%, rgba(255,60,60,.08), transparent 60%),
    linear-gradient(180deg, #0a0a0a, #070707 45%, #0b0b0b);
}

.card{
  max-width:560px;
  margin:0 auto;
  border-radius:var(--radius);
  padding:18px;
  border:1px solid var(--line);
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow: var(--shadow);
  position:relative;
  overflow:hidden;
}
.card:before{
  content:"";
  position:absolute; inset:-2px;
  background:
    radial-gradient(500px 200px at 20% 0%, rgba(255,43,43,.16), transparent 60%),
    radial-gradient(500px 200px at 80% 0%, rgba(255,43,43,.08), transparent 60%);
  pointer-events:none;
  filter: blur(0px);
  opacity:.9;
}

.hero{
  width:100%;
  border-radius:var(--radius2);
  display:block;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.25);
  box-shadow: var(--shadow2);
  transform: translateZ(0);
  transition: transform .25s ease, filter .25s ease, opacity .25s ease;
}
.hero:hover{ transform: translateY(-1px) scale(1.003); filter: saturate(1.05); }

h1{
  font-size:20px;
  margin:12px 0 6px;
  letter-spacing:.2px;
}
p{
  margin:0 0 14px;
  color:var(--muted);
  line-height:1.65;
}
label{
  display:block;
  margin:10px 0 6px;
  color:var(--muted);
  font-size:14px;
}

input{
  width:100%;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(8,8,8,.9);
  color:#fff;
  font-size:16px;
  outline:none;
  transition: border-color .2s ease, box-shadow .2s ease, transform .15s ease;
}
input:focus{
  border-color: rgba(255,43,43,.55);
  box-shadow: var(--glow);
}
input::placeholder{ color: rgba(255,255,255,.35); }

.row{display:flex; gap:10px; margin-top:12px}

/* =========================
   Buttons (‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô + ‡∏°‡∏µ Loading)
========================= */
button{
  -webkit-tap-highlight-color: transparent;
  flex:1;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  font-size:16px;
  font-weight:900;
  color:#fff;
  cursor:pointer;
  position:relative;
  overflow:hidden;
  transform: translateZ(0);
  transition: transform .14s ease, box-shadow .18s ease, filter .18s ease, border-color .18s ease, opacity .18s ease;
}
button:focus{ outline:none; }
button:focus-visible{
  box-shadow: 0 0 0 3px rgba(255,43,43,.35), 0 0 0 1px rgba(255,255,255,.15);
}

button:before{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(120deg, transparent, rgba(255,255,255,.18), transparent);
  transform: translateX(-120%);
  transition: transform .65s ease;
  pointer-events:none;
}
button:hover:before{ transform: translateX(120%); }
button:hover{
  transform: translateY(-1px);
  filter: saturate(1.05);
  box-shadow: 0 14px 36px rgba(0,0,0,.45);
  border-color: rgba(255,255,255,.18);
}
button:active{
  transform: translateY(0px) scale(.99);
  box-shadow: 0 10px 26px rgba(0,0,0,.35);
}

.btnAlt{
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
}
.btnMain{
  border-color: rgba(255,43,43,.35);
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 16px 42px rgba(255,43,43,.14), 0 16px 42px rgba(0,0,0,.45);
}
.btnMain:hover{
  box-shadow: 0 20px 56px rgba(255,43,43,.18), 0 18px 48px rgba(0,0,0,.45);
}

/* Disabled */
button:disabled{
  opacity:.55;
  cursor:not-allowed;
  transform:none;
  box-shadow:none;
}
button:disabled:before{ display:none; }

/* Loading state */
.btnLoading{
  pointer-events:none;
  opacity:.92;
}
.btnLoading .btnText{ opacity:0; }
.btnSpinner{
  position:absolute;
  left:50%; top:50%;
  width:18px; height:18px;
  margin:-9px 0 0 -9px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,.25);
  border-top-color: rgba(255,255,255,.95);
  animation: spin .7s linear infinite;
  display:none;
}
.btnLoading .btnSpinner{ display:block; }

@keyframes spin{
  to{ transform: rotate(360deg); }
}

/* =========================
   Message (‡πÄ‡∏î‡πâ‡∏á‡∏™‡∏ß‡∏¢)
========================= */
.msg{
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.25);
  white-space:pre-line;
  display:none;
  line-height:1.7;
  transform: translateY(6px);
  opacity:0;
  animation: pop .18s ease forwards;
}
@keyframes pop{
  to{ transform: translateY(0); opacity:1; }
}
.ok{
  border-color: rgba(54,211,153,.45);
  box-shadow: 0 0 0 1px rgba(54,211,153,.12) inset;
}
.err{
  border-color: rgba(255,90,95,.50);
  box-shadow: 0 0 0 1px rgba(255,90,95,.14) inset;
}

.hint{
  font-size:12px;
  color:#bfbfbf;
  margin-top:10px;
  line-height:1.7;
}

/* =========================
   Copy box (‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô)
========================= */
.copyBox{
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  border:1px dashed rgba(255,255,255,.25);
  background:rgba(0,0,0,.25);
  display:none;
  align-items:center;
  gap:10px;
  animation: pop .18s ease forwards;
}
.copyCode{
  flex:1;
  font-weight:1000;
  font-size:16px;
  letter-spacing:1px;
  user-select:all;
}
.copyBtn{
  padding:10px 14px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.10);
  cursor:pointer;
  font-weight:1000;
  color:#fff;
  background: linear-gradient(135deg,#22c55e,#16a34a);
}
.copyBtn:hover{ transform: translateY(-1px); }
.copyBtn.copied{
  background:linear-gradient(135deg,#3b82f6,#2563eb);
}

/* =========================
   Modal (‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô)
========================= */
.modal{
  position:fixed; inset:0;
  background: rgba(0,0,0,.72);
  display:none;
  align-items:center;
  justify-content:center;
  padding:18px;
  z-index:9999;
  backdrop-filter: blur(6px);
}
.modal.show{display:flex}
.modalCard{
  width:min(560px, 100%);
  border-radius:18px;
  padding:16px;
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
  box-shadow:0 22px 70px rgba(0,0,0,.78);
  transform: translateY(10px);
  opacity:0;
  animation: modalIn .18s ease forwards;
}
@keyframes modalIn{
  to{ transform: translateY(0); opacity:1; }
}
.modalTitle{font-weight:1000;font-size:18px;margin-bottom:10px}
.modalText{color:#e9e9e9;line-height:1.75;margin-bottom:12px}
.modalBtnMain{
  width:100%;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  font-weight:1000;
  cursor:pointer;
  color:#fff;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
}
.modalBtnMain:hover{ transform: translateY(-1px); }
.modalBtnMain:active{ transform: translateY(0) scale(.99); }

/* ‡∏•‡∏î‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ reduce motion */
@media (prefers-reduced-motion: reduce){
  *{ animation:none!important; transition:none!important; }
}
</style>
</head>

<body>
<div class="card">

<!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ -->
<img
  id="heroImg"
  class="hero"
  src="https://img5.pic.in.th/file/secure-sv1/photo_--_--2bb7d3a2870ef8d6.jpg"
  alt="‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ü‡∏£‡∏µ"
  loading="eager"
  decoding="async"
/>

<h1>üéÅ ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏à‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 38,888 ‡∏ö‡∏≤‡∏ó üéÅ</h1>
<p>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î (‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)</p>

<label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
<input id="phone" inputmode="numeric" placeholder="‡πÄ‡∏ä‡πà‡∏ô 0611111111"/>

<div class="row">
  <button id="btnCheck" class="btnAlt" type="button">
    <span class="btnText">‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</span>
    <span class="btnSpinner" aria-hidden="true"></span>
  </button>

  <button id="btnJoin" class="btnMain" type="button" disabled>
    <span class="btnText">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</span>
    <span class="btnSpinner" aria-hidden="true"></span>
  </button>
</div>

<button id="btnPoll" class="btnAlt" type="button" style="margin-top:10px;width:100%">
  <span class="btnText">‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ / ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î</span>
  <span class="btnSpinner" aria-hidden="true"></span>
</button>

<div id="msg" class="msg"></div>

<div id="copyWrap" class="copyBox">
  <div id="promoCode" class="copyCode">RRXXXXXXXX</div>
  <button id="btnCopy" class="copyBtn" type="button">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
</div>

<div class="hint">
* ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏ö 365 ‡∏ö‡∏≤‡∏ó‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏î‡πâ<br>
* ‡∏ó‡∏≥‡∏¢‡∏≠‡∏î 10 ‡πÄ‡∏ó‡πà‡∏≤ ‡∏ñ‡∏≠‡∏ô‡πÑ‡∏î‡πâ 10 ‡πÄ‡∏ó‡πà‡∏≤
</div>

</div>

<div id="ruleModal" class="modal" aria-hidden="true">
  <div class="modalCard" role="dialog" aria-modal="true">
    <div class="modalTitle">üìå ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô)</div>
    <div class="modalText">
      1) ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏ö 365 ‡∏ö‡∏≤‡∏ó<br>
      2) ‡∏ó‡∏≥‡∏¢‡∏≠‡∏î 10 ‡πÄ‡∏ó‡πà‡∏≤ ‡∏ñ‡∏≠‡∏ô‡πÑ‡∏î‡πâ 10 ‡πÄ‡∏ó‡πà‡∏≤<br>
      3) 1 ‡∏Ñ‡∏ô / 1 ‡∏¢‡∏π‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô<br>
      4) ‡πÇ‡∏Ñ‡πâ‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
    </div>
    <button class="modalBtnMain" id="modalAcknowledge" type="button">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
  </div>
</div>

<script>
/* üî¥ ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå exec ‡∏Ç‡∏≠‡∏á Google Apps Script (Deploy Web App) */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwvj6_Lb6cHdMgjXaxNhjPaiWgS7vYBckyLAbYl7UgfxUAHj42ePmENuPU0gkstg9dSmA/exec";

const $phone=document.getElementById("phone");
const $btnCheck=document.getElementById("btnCheck");
const $btnJoin=document.getElementById("btnJoin");
const $btnPoll=document.getElementById("btnPoll");
const $msg=document.getElementById("msg");
const $copyWrap=document.getElementById("copyWrap");
const $promoCode=document.getElementById("promoCode");
const $btnCopy=document.getElementById("btnCopy");
const $ruleModal=document.getElementById("ruleModal");
const $modalAck=document.getElementById("modalAcknowledge");

function openRule(){ $ruleModal.classList.add("show"); document.body.style.overflow="hidden"; }
function closeRule(){ $ruleModal.classList.remove("show"); document.body.style.overflow=""; }
$modalAck.onclick=closeRule;

/* ===== Loading UI helpers ===== */
function setBtnLoading(btn, isLoading){
  if(!btn) return;
  if(isLoading){
    btn.classList.add("btnLoading");
    btn.setAttribute("aria-busy","true");
    btn.dataset.prevDisabled = btn.disabled ? "1" : "0";
    btn.disabled = true; // ‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î
  }else{
    btn.classList.remove("btnLoading");
    btn.removeAttribute("aria-busy");
    // ‡∏Ñ‡∏∑‡∏ô disabled ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ disabled
    const prev = btn.dataset.prevDisabled === "1";
    delete btn.dataset.prevDisabled;
    if(!prev) btn.disabled = false;
  }
}

/* ‡∏£‡∏ß‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏≠‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡∏¥‡∏á request */
function setAllLoading(on){
  setBtnLoading($btnCheck, on);
  setBtnLoading($btnPoll, on);
  // btnJoin ‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏á: ‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡πâ‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏ß‡πâ ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏£‡∏¥‡∏á
  if(on) setBtnLoading($btnJoin, true);
}

function show(t,type="ok"){
  $msg.style.display="block";
  $msg.className="msg "+(type==="err"?"err":"ok");
  $msg.textContent=t;
}
function hideMsg(){ $msg.style.display="none"; $msg.textContent=""; }
function hideCopy(){ $copyWrap.style.display="none"; $promoCode.textContent="RRXXXXXXXX"; }

function normalizePhone(v){
  let s=String(v||"").trim(); const th="‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô";
  for(let i=0;i<th.length;i++) s=s.replace(new RegExp(th[i],"g"),String(i));
  let p=s.replace(/\D/g,"");
  if(p.startsWith("0066")) p=p.slice(2);
  if(p.startsWith("66")) p="0"+p.slice(2);
  if(!p.startsWith("0") && p.length===9) p="0"+p;
  return /^0[689]\d{8}$/.test(p)?p:"";
}

function jsonp(params){
  return new Promise((res,rej)=>{
    const cb="cb_"+Math.random().toString(36).slice(2);
    params.callback=cb;
    params._ts=Date.now();

    const s=document.createElement("script");
    s.src = SCRIPT_URL + "?" + new URLSearchParams(params).toString();

    window[cb]=(d)=>{ try{ delete window[cb]; }catch(_){ window[cb]=undefined; } s.remove(); res(d); };
    s.onerror=()=>{ try{ delete window[cb]; }catch(_){ window[cb]=undefined; } s.remove(); rej(new Error("JSONP_ERROR")); };

    document.body.appendChild(s);
  });
}

$btnCopy.onclick=async()=>{
  const t=$promoCode.textContent.trim(); if(!t) return;
  await navigator.clipboard.writeText(t);
  $btnCopy.classList.add("copied");
  setTimeout(()=>$btnCopy.classList.remove("copied"),1200);
};

$btnCheck.onclick=async()=>{
  hideMsg(); hideCopy();
  $btnJoin.disabled=true;

  const p=normalizePhone($phone.value);
  if(!p){ show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","err"); return; }

  setAllLoading(true);
  show("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå...");
  const d=await jsonp({action:"check",phone:p}).catch(()=>null);
  setAllLoading(false);

  // ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ btnJoin ‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
  $btnJoin.disabled = true;

  if(!d){ show("‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏ä‡πá‡∏Ñ SCRIPT_URL / Deploy)","err"); return; }

  if(!d.ok){
    show(d.msg || "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç","err");
    return;
  }

  show(d.msg || "‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÑ‡∏î‡πâ","ok");
  $btnJoin.disabled=false;
};

$btnJoin.onclick=async()=>{
  hideMsg(); hideCopy();

  const p=normalizePhone($phone.value);
  if(!p){ show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","err"); return; }

  setBtnLoading($btnJoin,true);
  setBtnLoading($btnCheck,true);
  setBtnLoading($btnPoll,true);

  show("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°...");
  const d=await jsonp({action:"register",phone:p}).catch(()=>null);

  setBtnLoading($btnJoin,false);
  setBtnLoading($btnCheck,false);
  setBtnLoading($btnPoll,false);

  // ‡∏´‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß: ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏° join ‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥
  $btnJoin.disabled = true;

  if(!d){ show("‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏ä‡πá‡∏Ñ SCRIPT_URL / Deploy)","err"); return; }

  if(!d.ok){
    show(d.msg || "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","err");
    return;
  }

  show(d.msg || "‚úÖ ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥","ok");
  openRule();
};

$btnPoll.onclick=async()=>{
  hideMsg(); hideCopy();

  const p=normalizePhone($phone.value);
  if(!p){ show("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","err"); return; }

  setBtnLoading($btnPoll,true);
  setBtnLoading($btnCheck,true);
  // join ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏ã‡πâ‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ
  setBtnLoading($btnJoin,true);

  show("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞...");
  const d=await jsonp({action:"poll",phone:p}).catch(()=>null);

  setBtnLoading($btnPoll,false);
  setBtnLoading($btnCheck,false);
  setBtnLoading($btnJoin,false);

  // ‡∏Ñ‡∏∑‡∏ô join ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ú‡πà‡∏≤‡∏ô check ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡∏°‡πà)
  $btnJoin.disabled = true;

  if(!d){ show("‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏ä‡πá‡∏Ñ SCRIPT_URL / Deploy)","err"); return; }

  if(!d.ok){
    show(d.msg || "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°","err");
    return;
  }

  if(d.status==="APPROVED" && d.promo_code){
    $promoCode.textContent=d.promo_code;
    $copyWrap.style.display="flex";
    show("üéâ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢","ok");
    openRule();
    return;
  }

  if(d.status==="PENDING"){ show("‚è≥ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô","ok"); return; }
  if(d.status==="REJECTED"){ show("‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô","err"); return; }
  if(d.status==="USED"){ show("‚ö†Ô∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß","err"); return; }

  show(d.msg || ("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: "+(d.status||"UNKNOWN")),"ok");
};
</script>
</body>
</html>
